# Create a csv file of processing logs nginx/apache for graphs, like, X=hour, Y=hits and Legend line=IP

### Crontab

        00 01 * * * cd "/path/to/scripts" && sh nginx_toptwenty.sh

### Results:

#### YYYMMDD_nginx.txt
        Hits  IP

        17440 66.xxx.85.44
        17510 201.xxx.31.125
        18087 189.xxx.32.130
        19357 189.xxx.36.2
        19876 52.xxx.10.194
        20235 191.xxx.165.165
        23320 66.xxx.85.55
        23386 200.xxx.253.199
        24711 200.xxx.205.20
        25057 66.xxx.85.42
        25110 177.xxx.128.130
        25299 201.xxx.198.204
        26197 189.xxx.20.149
        26733 66.xxx.85.63
        28793 189.xxx.128.242
        34052 66.xxx.85.59
        41043 66.xxx.85.61
        43969 34.xxx.179.174
        51266 52.xxx.90.11
        65142 35.xxx.152.237
                  
#### ips.txt
        177.xxx.128.130 189.xxx.128.242 189.xxx.20.149 189.xxx.32.130 189.xxx.36.2 191.xxx.165.165 200.xxx.205.20 200.xxx.253.199 201.xxx.31.125 201.xxx.198.204 34.xxx.179.174 35.xxx.152.237 52.xxx.10.194 52.xxx.90.11 66.xxx.85.42 66.xxx.85.44 66.xxx.85.55 66.xxx.85.59 66.xxx.85.61 66.xxx.85.63 
                  
#### lista.txt
        '177.xxx.128.130\|189.xxx.128.242\|189.xxx.20.149\|189.xxx.32.130\|189.xxx.36.2\|191.xxx.165.165\|200.xxx.205.20\|200.xxx.253.199\|201.xxx.31.125\|201.xxx.198.204\|34.xxx.179.174\|35.xxx.152.237\|52.xxx.10.194\|52.xxx.90.11\|66.xxx.85.42\|66.xxx.85.44\|66.xxx.85.55\|66.xxx.85.59\|66.xxx.85.61\|66.xxx.85.63'
                  
#### planilha.csv

        Hora; 177.xxx.128.130;  189.xxx.128.242;  189.xxx.20.149;  189.xxx.32.130;  189.xxx.36.2;  191.xxx.165.165;  200.xxx.205.20;  200.xxx.253.199;  201.xxx.31.125;  201.xxx.198.204;  34.xxx.179.174;  35.xxx.152.237;  52.xxx.10.194;  52.xxx.90.11;  66.xxx.85.42;  66.xxx.85.44;  66.xxx.85.55;  66.xxx.85.59;  66.xxx.85.61;  66.xxx.85.63;
        0; 136;  57;  0;  0;  0;  0;  117;  3;  0;  13;  0;  0;  2038;  0;  490;  1000;  519;  691;  1998;  1400;
        1; 11;  73;  119;  0;  0;  0;  112;  27;  0;  0;  0;  0;  0;  0;  664;  832;  793;  1401;  1677;  1185;
        2; 92;  107;  31;  0;  3;  0;  268;  11;  0;  3;  0;  0;  1287;  0;  276;  408;  304;  502;  613;  481;
        3; 32;  66;  7;  0;  87;  0;  2;  17;  0;  20;  0;  0;  1145;  0;  117;  256;  212;  412;  498;  478;
        4; 34;  21;  62;  20;  3;  0;  24;  1;  0;  101;  0;  4863;  2004;  0;  226;  184;  509;  994;  340;  340;
        5; 0;  46;  0;  0;  15;  0;  5;  0;  0;  34;  0;  3740;  816;  0;  1295;  716;  419;  730;  1021;  1149;
        6; 614;  92;  33;  0;  2;  0;  276;  72;  0;  157;  15060;  6376;  1366;  17976;  1436;  813;  1242;  2203;  1910;  1677; 
        7; 3009;  1817;  639;  1615;  411;  633;  257;  282;  444;  1812;  21046;  4694;  1990;  21048;  1552;  1101;  1937;  2523;  2855;  2302; 
        8; 4805;  4030;  2599;  1687;  134;  3272;  2023;  1930;  2248;  3427;  6479;  2386;  1099;  8140;  1697;  685;  1288;  2283;  1918;  1619;
        9; 2924;  4599;  3282;  1895;  1464;  2235;  4178;  2152;  2750;  4244;  1341;  3806;  584;  3580;  1456;  841;  1443;  1645;  2760;  1136;
        10; 3648;  3908;  2856;  1868;  287;  3968;  4497;  3523;  2027;  3442;  43;  3033;  326;  522;  1347;  861;  743;  2039;  2239;  1113;
        11; 1287;  1927;  2132;  1069;  4673;  2965;  3457;  1559;  1418;  2389;  0;  2745;  128;  0;  1082;  648;  625;  1352;  1650;  1326;
        12; 1080;  1332;  754;  1846;  556;  2303;  1014;  2794;  1956;  714;  0;  2287;  1153;  0;  1061;  709;  896;  1668;  1813;  718;
        13; 1028;  1143;  1126;  1265;  2153;  1346;  495;  2060;  1417;  1487;  0;  3106;  891;  0;  1687;  944;  1710;  1526;  2656;  2187;
        14; 2122;  2076;  3684;  1648;  781;  1253;  1949;  2300;  2590;  1654;  0;  3276;  313;  0;  1728;  682;  1388;  1615;  2699;  1066;
        15; 2550;  2902;  2249;  1190;  2750;  1258;  2170;  1904;  1210;  726;  0;  3012;  432;  0;  1192;  952;  1159;  2144;  1887;  1344;
        16; 768;  2338;  4113;  1737;  52;  702;  1365;  1570;  1450;  1780;  0;  3461;  777;  0;  1110;  1191;  466;  1081;  2541;  1320;
        17; 430;  1426;  569;  1216;  1138;  271;  1754;  1319;  0;  1179;  0;  2554;  410;  0;  874;  772;  999;  1450;  1848;  1109;
        18; 353;  378;  913;  721;  145;  29;  63;  837;  0;  1236;  0;  2685;  718;  0;  1414;  1462;  1262;  1536;  2351;  1334;
        19; 67;  165;  795;  0;  1622;  0;  234;  224;  0;  662;  0;  3200;  0;  0;  1072;  565;  1206;  1952;  1666;  1340; 
        20; 1;  82;  82;  137;  0;  0;  48;  437;  0;  45;  0;  1973;  1024;  0;  1163;  550;  1204;  1257;  1073;  529;
        21; 0;  25;  104;  18;  567;  0;  239;  238;  0;  110;  0;  2920;  0;  0;  843;  353;  1516;  1136;  1355;  432;
        22; 27;  95;  48;  52;  0;  0;  72;  126;  0;  10;  0;  2481;  958;  0;  466;  369;  532;  906;  804;  223; 
        23; 92;  87;  0;  103;  0;  0;  92;  0;  0;  39;  0;  2544;  417;  0;  771;  540;  884;  753;  810;  794;

#### Convert to table using ';' with separator

|Hora| 177.xxx.128.130|  189.xxx.128.242|  189.xxx.20.149|  189.xxx.32.130|  189.xxx.36.2|  191.xxx.165.165|  200.xxx.205.20|  200.xxx.253.199|  201.xxx.31.125|  201.xxx.198.204|  34.xxx.179.174|  35.xxx.152.237|  52.xxx.10.194|  52.xxx.90.11|  66.xxx.85.42|  66.xxx.85.44|  66.xxx.85.55|  66.xxx.85.59|  66.xxx.85.61|  66.xxx.85.63| 
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|
|0| 136|  57|  0|  0|  0|  0|  117|  3|  0|  13|  0|  0|  2038|  0|  490|  1000|  519|  691|  1998|  1400| 
|1| 11|  73|  119|  0|  0|  0|  112|  27|  0|  0|  0|  0|  0|  0|  664|  832|  793|  1401|  1677|  1185| 
|2| 92|  107|  31|  0|  3|  0|  268|  11|  0|  3|  0|  0|  1287|  0|  276|  408|  304|  502|  613|  481| 
|3| 32|  66|  7|  0|  87|  0|  2|  17|  0|  20|  0|  0|  1145|  0|  117|  256|  212|  412|  498|  478| 
|4| 34|  21|  62|  20|  3|  0|  24|  1|  0|  101|  0|  4863|  2004|  0|  226|  184|  509|  994|  340|  340| 
|5| 0|  46|  0|  0|  15|  0|  5|  0|  0|  34|  0|  3740|  816|  0|  1295|  716|  419|  730|  1021|  1149| 
|6| 614|  92|  33|  0|  2|  0|  276|  72|  0|  157|  15060|  6376|  1366|  17976|  1436|  813|  1242|  2203|  1910|  1677| 
|7| 3009|  1817|  639|  1615|  411|  633|  257|  282|  444|  1812|  21046|  4694|  1990|  21048|  1552|  1101|  1937|  2523|  2855|  2302| 
|8| 4805|  4030|  2599|  1687|  134|  3272|  2023|  1930|  2248|  3427|  6479|  2386|  1099|  8140|  1697|  685|  1288|  2283|  1918|  1619| 
|9| 2924|  4599|  3282|  1895|  1464|  2235|  4178|  2152|  2750|  4244|  1341|  3806|  584|  3580|  1456|  841|  1443|  1645|  2760|  1136| 
|10| 3648|  3908|  2856|  1868|  287|  3968|  4497|  3523|  2027|  3442|  43|  3033|  326|  522|  1347|  861|  743|  2039|  2239|  1113| 
|11| 1287|  1927|  2132|  1069|  4673|  2965|  3457|  1559|  1418|  2389|  0|  2745|  128|  0|  1082|  648|  625|  1352|  1650|  1326| 
|12| 1080|  1332|  754|  1846|  556|  2303|  1014|  2794|  1956|  714|  0|  2287|  1153|  0|  1061|  709|  896|  1668|  1813|  718| 
|13| 1028|  1143|  1126|  1265|  2153|  1346|  495|  2060|  1417|  1487|  0|  3106|  891|  0|  1687|  944|  1710|  1526|  2656|  2187| 
|14| 2122|  2076|  3684|  1648|  781|  1253|  1949|  2300|  2590|  1654|  0|  3276|  313|  0|  1728|  682|  1388|  1615|  2699|  1066| 
|15| 2550|  2902|  2249|  1190|  2750|  1258|  2170|  1904|  1210|  726|  0|  3012|  432|  0|  1192|  952|  1159|  2144|  1887|  1344| 
|16| 768|  2338|  4113|  1737|  52|  702|  1365|  1570|  1450|  1780|  0|  3461|  777|  0|  1110|  1191|  466|  1081|  2541|  1320| 
|17| 430|  1426|  569|  1216|  1138|  271|  1754|  1319|  0|  1179|  0|  2554|  410|  0|  874|  772|  999|  1450|  1848|  1109| 
|18| 353|  378|  913|  721|  145|  29|  63|  837|  0|  1236|  0|  2685|  718|  0|  1414|  1462|  1262|  1536|  2351|  1334| 
|19| 67|  165|  795|  0|  1622|  0|  234|  224|  0|  662|  0|  3200|  0|  0|  1072|  565|  1206|  1952|  1666|  1340| 
|20| 1|  82|  82|  137|  0|  0|  48|  437|  0|  45|  0|  1973|  1024|  0|  1163|  550|  1204|  1257|  1073|  529| 
|21| 0|  25|  104|  18|  567|  0|  239|  238|  0|  110|  0|  2920|  0|  0|  843|  353|  1516|  1136|  1355|  432| 
|22| 27|  95|  48|  52|  0|  0|  72|  126|  0|  10|  0|  2481|  958|  0|  466|  369|  532|  906|  804|  223| 
|23| 92|  87|  0|  103|  0|  0|  92|  0|  0|  39|  0|  2544|  417|  0|  771|  540|  884|  753|  810|  794|


#### Graph of results

![graph of results](https://github.com/Iakim/Nginx-Log-Csv/raw/master/Nginx_Graph.png)
